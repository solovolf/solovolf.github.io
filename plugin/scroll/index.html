<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <meta name="viewport"
          content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <link rel="stylesheet" href="css/loaders.css">
    <style>
        body {
            margin: 0;
        }

        .loader {
            background-color: #ed5565;
            height: 50px;
            width: 100%;
            box-sizing: border-box;
            display: flex;
            align-items: center;
            justify-content: center;
            display: none;
        }

        ul {
            padding: 0;
        }

        li {
            line-height: 40px;
            height: 40px;
            font-size: 16px;
        }

        #refresh_wrapper {
            -webkit-overflow-scrolling: touch;
        }

        #refresh_wrapper ul {
            margin: 0;
            padding: 0;
            background-color: #888888;
        }

        .loadtip {
            text-align: center;
            color: #ed5565;
            height: 50px;
            line-height: 50px;
            border-top: 1px solid #2f4f90;
            border-bottom: 1px solid #2f4f90;
            box-sizing: border-box;
        }
    </style>
</head>
<body>
<!--<div style="height: 300px;overflow: auto">-->
    <div style="width: 100%;height: 100px;background-color:#afafbc;">
        头部
    </div>
    <div id="refresh_wrapper">
        <ul>
            <li>原来的文字</li>
            <li>原来的文字</li>
            <li>原来的文字</li>
            <li>原来的文字</li>
            <li>原来的文字</li>
            <li>原来的文字</li>
            <li>原来的文字</li>
            <li>原来的文字</li>
            <li>原来的文字</li>
            <li>原来的文字</li>
            <li>原来的文字</li>
            <li>原来的文字</li>
            <li>原来的文字</li>
            <li>原来的文字</li>
            <li>原来的文字</li>
        </ul>
        <div class="loader loaded">
            <div class="loader-inner ball-clip-rotate-pulse">
                <div></div>
                <div></div>
            </div>
        </div>
        <div class="loadtip">
            上拉加载更多
        </div>
    </div>
<!--</div>-->

<script src="js/scroll.js"></script>
<script>
    (function () {

        document.body.addEventListener('touchend',function(){
            alert(33)
        })

        var countLi = 0;

        /*
         两个参数
         一个是需要下拉刷新的元素的id
         另一个是下拉刷新的间隔
         下拉刷新的间隔可以传正负数
         负数代表距离拉到底部还剩多少px时刷新
         正数代表距离拉到超出底部多少px时刷新
         */

        var scrollRefresh = new ScrollRefresh('refresh_wrapper', {scrollDistance: -10})
        scrollRefresh.pullUpEvent(function (scrollObj) {
            //加载中的样式替换
            var wrapper = document.getElementById("refresh_wrapper");
            var tip = wrapper.querySelector('.loadtip');

            var loader = wrapper.querySelector('.loader');
            tip.style.display = 'none';
            loader.style.display = 'flex';


            setTimeout(function () {
                if (countLi > 30) {
                    tip.innerHTML = "没有更多了";
                } else {
                    var frag = document.createDocumentFragment();
                    for (var i = 0; i < 10; i++) {
                        var li = document.createElement('li');
                        li.innerHTML = '加载出来的文字' + (++countLi);
                        frag.appendChild(li);
                    }
                    wrapper.querySelector('ul').appendChild(frag);
                    //打开开关
                    scrollObj.scrollDisabled = false;
                }
                //切换回样式
                loader.style.display = 'none';
                tip.style.display = 'block';
            }, 1000)
        })
    })()
</script>
</body>
</html>